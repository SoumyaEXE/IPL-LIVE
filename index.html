<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IPL Live - Hindi, English, SP2 & Tamil</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: #000;
      color: white;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .header {
      position: fixed;
      top: 0;
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      padding: 12px 0;
      font-size: 1.8rem;
      font-weight: 700;
      color: white;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
      box-shadow: 0px 4px 10px rgba(255, 255, 255, 0.2);
      z-index: 100;
      backdrop-filter: blur(8px);
    }

    .tab-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 80px;
      gap: 10px;
    }

    .tab {
      padding: 10px 20px;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      border: 2px solid white;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      transition: 0.3s;
      flex: 1 1 150px;
      text-align: center;
    }

    .tab.active {
      background: #ff4081;
      color: white;
      box-shadow: 0px 0px 15px rgba(255, 64, 129, 1);
    }

    .stream-container {
      display: none;
      margin-top: 20px;
      width: 90%;
      max-width: 900px;
    }

    .stream-container.active {
      display: block;
    }

    iframe, video {
      width: 100%;
      height: 520px;
      border-radius: 12px;
      background: #000;
      border: 2px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0px 0px 12px rgba(255, 255, 255, 0.5);
    }

    .footer {
      margin-top: 20px;
      font-size: 1rem;
      font-weight: 500;
    }

    .footer a {
      color: white;
      text-decoration: none;
      font-weight: 700;
      transition: 0.3s;
    }

    .footer a:hover {
      color: #ff4081;
      text-shadow: 0px 0px 15px rgba(255, 64, 129, 1);
    }

    @media (max-width: 768px) {
      .header {
        font-size: 1.5rem;
      }

      .tab-container {
        flex-direction: column;
      }

      .tab {
        flex: none;
      }

      iframe, video {
        height: 300px;
      }
    }
  </style>
</head>
<body>

  <div class="header">IPL Live 2025</div>

  <div class="tab-container">
    <div id="hindi-tab" class="tab active">üì∫ Hindi Stream</div>
    <div id="english-tab" class="tab">üì∫ English Stream</div>
    <div id="sp2-tab" class="tab">üì∫ SP2 Stream</div>
    <div id="tamil-tab" class="tab">üì∫ Tamil Stream</div>
  </div>

  <!-- Hindi Stream -->
  <div id="hindi-stream" class="stream-container active">
    <iframe id="hindi-iframe" frameborder="0" allowfullscreen src="https://cdn.crichdplays.ru/embed2.php?id=starsp3" scrolling="no"></iframe>
  </div>

  <!-- English Stream (HLS) -->
  <div id="english-stream" class="stream-container">
    <video id="video" controls playsinline></video>
  </div>

  <!-- SP2 Stream -->
  <div id="sp2-stream" class="stream-container">
    <iframe id="sp2-iframe" frameborder="0" allowfullscreen src="https://cdn.crichdplays.ru/embed2.php?id=starsp2" scrolling="no"></iframe>
  </div>

  <!-- Tamil Stream -->
  <div id="tamil-stream" class="stream-container">
    <iframe id="tamil-iframe" frameborder="0" allowfullscreen src="https://cdn.crichdplays.ru/embed2.php?id=starsp1tam" scrolling="no"></iframe>
  </div>

  <div class="footer">
    Made with ‚ù§Ô∏è by <a href="https://github.com/SoumyaEXE" target="_blank">Soumya</a>
  </div>

  <script>
    const tabs = document.querySelectorAll(".tab");
    const streams = document.querySelectorAll(".stream-container");
    const video = document.getElementById('video');
    
    // Store original iframe sources
    const iframeSources = {
      'hindi-iframe': "https://cdn.crichdplays.ru/embed2.php?id=starsp3",
      'sp2-iframe': "https://cdn.crichdplays.ru/embed2.php?id=starsp2", 
      'tamil-iframe': "https://cdn.crichdplays.ru/embed2.php?id=starsp1tam"
    };

    // Function to stop all streams
    function stopAllStreams() {
      // Pause the HTML5 video if it exists
      if (video) {
        video.pause();
      }
      
      // Reset all iframes by removing and recreating them
      for (const [id, src] of Object.entries(iframeSources)) {
        const iframe = document.getElementById(id);
        if (iframe) {
          const parent = iframe.parentNode;
          const newIframe = document.createElement('iframe');
          newIframe.id = id;
          newIframe.frameBorder = "0";
          newIframe.allowFullscreen = true;
          newIframe.scrolling = "no";
          // Only set src for the active tab to avoid loading resources unnecessarily
          if (parent.classList.contains('active')) {
            newIframe.src = src;
          }
          parent.replaceChild(newIframe, iframe);
        }
      }
    }

    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        // Deactivate all tabs and hide all streams
        tabs.forEach(t => t.classList.remove("active"));
        streams.forEach(s => s.classList.remove("active"));
        
        // Stop all streams first
        stopAllStreams();

        // Activate the clicked tab and corresponding stream
        tab.classList.add("active");
        const activeStream = document.getElementById(`${tab.id.replace('-tab', '-stream')}`);
        activeStream.classList.add("active");

        // If this is an iframe-based stream, ensure it has its source set
        if (tab.id !== 'english-tab') {
          const iframeId = tab.id.replace('-tab', '-iframe');
          const iframe = document.getElementById(iframeId);
          if (iframe && !iframe.src) {
            iframe.src = iframeSources[iframeId];
          }
        }
        
        // Play video if English stream is activated
        if (tab.id === 'english-tab' && video) {
          // Small delay to ensure everything is ready
          setTimeout(() => {
            video.play().catch(e => console.log("Failed to autoplay:", e));
          }, 100);
        }
      });
    });

    document.addEventListener("DOMContentLoaded", () => {
      const streamURL = "https://live.tsports.com/mobile_hls/tsports_live_2/playlist.m3u8";

      if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(streamURL);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          let highestHD = hls.levels.findIndex(level => level.height >= 720);
          if (highestHD !== -1) hls.currentLevel = highestHD;
        });
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = streamURL;
      }

      // Only load iframes for the active tab on initial page load
      const activeTab = document.querySelector('.tab.active');
      if (activeTab.id !== 'english-tab') {
        const inactiveIframes = document.querySelectorAll('.stream-container:not(.active) iframe');
        inactiveIframes.forEach(iframe => {
          iframe.src = ''; // Remove source to prevent loading
        });
      }
    });
  </script>
</body>
</html>
